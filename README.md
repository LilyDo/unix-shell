# A simple Unix Shell

It implements all shell commands and supports pipelining, redirection and background execution

Implemented and tested with an arm64 machine

## How to Run?

1. Run `make` command to compile.
2. Run `./shell` to execute the shell.

## Features of the shell

### Basic functionalities

1. The source code can be compiled and built using the provided makefile.

2. The shell can execute simple command lines repeatedly using `execvp`. All the simple commands available in Bash can be executed

3. Includes basic built-in commands: `prompt`, `pwd`, `cd` and `exit`, which are detailed in the Built-in Commands section.

4. The shell can tokenize command with different number of spaces separating tokens

5. the shell can process commands with multiple command-line arguments

6. Wildcards such as * can be expanded using glob to match filenames.

7. `SIGINT`, `SIGQUIT` and `SIGTSTP` generated by typing Ctrl-C, Ctrl-\ and Ctrl-Z from shell prompt are ignored

8. Zombie processes are claimed.

### Advanced functionalities

1. Supports sequential execution. The commands separated by `;` are executed one after the other. Signal handling enable displaying info of child process when terminated.
The order in which the command is broken down is: `;` or `&` , `|` (piping) , `<,>,>>` (redirection) , `&` (background) 

2. Supports concurrent execution. Commands ending with `&` are treated as a background process and the shell does not wait for its execution. The shell keeps track of all background processes and alerts the user on their completion with `pid`

3. Redirection is supported. The shell redirects the standard input and standard output to files.
`<`is used for input redirection. `>` (overwriting) and `>>` (apending) are used for output redirection.
Example:
    ```
    Input Redirect
        $ cat < 1.txt

    Output Redirection
        $ ls -l > 2.txt
        $ echo "Hello World" > 2.txt
    ```

4. Shell pipeline is provided using `|`, where the output of one command serves as input for the next.
Example:
    ```
    $ ls -lt | more
    ```

5. The shell can handle long shell pipeline jobs (multiple pipelines in a single job)

6. Built-in `history` is included, which prints the last 10 in order. `!xyz` searches the command history in reverse to find the most recent command that start with prefix xyz.

7. The shell can handle complex command lines with multiple commands connected by `;` or `&`. 

8. Complex command lines with multiple jobs, some with redirections and some with pipelines.  

9. Handling of slow system calls

### Build-in Commands

1. `prompt [new prompt]` <br>
    * Implemented in `build_in.c`
    * Changes the shell prompt to [new prompt].

2. `pwd` <br>
    * Implemented in `build_in.c`
    * Prints the current working directory.
    * Uses the `getcwd()` system call.

3. `cd [location]` <br>
    * Implemented in `build_in.c`
    * Changes the current working directory to the mentioned directory. If no parameter is given, it changes the directory to the root directory of the shell.
    * If `~` is present in the given `location`, it is replaced with the home directory of the shell.
    * If `location` is `-`, it is interpreted as the previous working directory of the shell.
    * Implemented using `chdir()` system call.

4. `history` <br>
    * Implemented in `build_in.c`
    * Prints up to the last 10 previous commands run.

8. `![string]` <br>
    * Implemented in `execute_cmd.c`
    * repeat the last command that starts with a string using !string.

15. `exit`
    * Implemented in `execute_cmd.c`
    * Quits the terminal.


## List of files

* `README.md` <br>
    Describe funtionatities and structure of the shell program.

* `header.h` <br>
    Contains all required headers, global variables, functions and struct

* `shell.c` <br>
   This is the main shell loop. Contains the `main()`. Shell execution starts from here.

* `init.c` <br>
    Conatins some basic setups for the shell such as `get_home_dir()`, `update_cwd_relative` and  `handle_signal`

* `built_in.c` <br>
   Contains the implementation of built_in commands such as `pwd`, `cd`, `history` etc
   
* `redirect.c` <br> 
    Contains the implementation of input and output redirection using `dup2()` call.
   
* `parser.c` <br> 
    Contains functions to read input using `fgets()`, tokenize input with `;` or `&` using `strtok()` system call, check for pipelining or redirection and set to global variables.

* `execute_cmd.c` <br>
    Executes shell commands with support for foreground, background, and built-in operations. `execute_command)()` forks processes, sets group IDs, handles I/O, restores signals, and manages terminal control.

    Implement piping using `pipe()` and `execvp()`


## Features that haven't been implemented or are not fully functional
1. Special character intepretation of command token. 

    During tokenization, the program cannot identify quoted tokens or tokens includes escaping special characters.

2. Up and Down arrow keys for shell history. Check whether the user can display the previous command with the up arrow key and repeat the command by typing ENTER key.


3. Wildcards expand is implemented but `?` failed the tests to match file names while `*` successed.

4. Standard error redirection to file